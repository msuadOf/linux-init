# git连接直接clone的支持
## 由于这是preexec会在每个命令之前执行，可能影响性能

function git_clone_preexec() {
    local cmd="$1"
    # 匹配以git@开头，包含冒号，并以.git结尾的模式
    if [[ "$cmd" =~ ^git@[a-zA-Z0-9_.-]+:[a-zA-Z0-9_./-]+\.git$ ]]; then
        echo "检测到Git SSH地址，执行: git clone $cmd"
        git clone "$cmd"
        return 1  # 返回非0值，阻止原命令执行
    # 匹配以http://或https://开头，并以.git结尾的模式
    elif [[ "$cmd" =~ ^https?://[a-zA-Z0-9_./-]+\.git$ ]]; then
        echo "检测到Git HTTP地址，执行: git clone $cmd"
        git clone "$cmd"
        return 1
    fi
    return 0  # 继续执行原命令
}

## 将函数添加到preexec_functions数组中
autoload -Uz add-zsh-hook
add-zsh-hook preexec git_clone_preexec
